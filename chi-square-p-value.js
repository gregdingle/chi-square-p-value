!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define("analyse",[],r):"object"==typeof exports?exports.analyse=r():t.analyse=r()}(window,function(){return function(t){var r={};function a(n){if(r[n])return r[n].exports;var e=r[n]={i:n,l:!1,exports:{}};return t[n].call(e.exports,e,e.exports,a),e.l=!0,e.exports}return a.m=t,a.c=r,a.d=function(t,r,n){a.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,r){if(1&r&&(t=a(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var e in t)a.d(n,e,function(r){return t[r]}.bind(null,e));return n},a.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(r,"a",r),r},a.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},a.p="",a(a.s=1)}([function(t,r,a){"use strict";var n="Matrix 1.01",e=new function(){this.version=n;var t=Math.abs,r=Math.pow(2,-40);function a(a){return t(a)<r?0:a}function i(t,r,a){if(!a.isMatrix)throw"***ERROR: Argument "+r+" of Matrix."+t+' is not a Matrix; its value is "'+a+'".'}function o(t){for(var r=t.length,n=0;n<r;n++){if(!(t[n]instanceof Array))throw"***ERROR: in Matrix.create: argument 1 is not a 2D array.";if(t[n].length!=t[0].length)throw"***ERROR: in Matrix.create: argument 1 has different length rows."}for(var e=t[0].length,i=new Array(r),n=0;n<r;n++){i[n]=new Array(e);for(var o=0;o<e;o++)i[n][o]=a(t[n][o])}var _=new Object;return _.m=r,_.n=e,_.mat=i,_.isMatrix=!0,_}function _(t,r){for(var a=new Array(t),n=0;n<t;n++)a[n]=new Array(r);var e=new Object;return e.m=t,e.n=r,e.mat=a,e.isMatrix=!0,e}this.getEPS=function(){return r},this.setEPS=function(t){r=t},this.create=function(t,r){var a=t instanceof Array;if(!a&&"number"!=typeof t)throw"***ERROR: in Matrix.create: argument 1 is not an array or a number.";if(a&&null!=r)throw"***ERROR: in Matrix.create: argument 1 is an array but argument 2 is also present.";return a?o(t):_(t,r)},this.identity=function(t,r){for(var a=_(t,r),n=0;n<a.m;n++)for(var e=0;e<a.n;e++)a.mat[n][e]=0;for(var n=0;n<Math.min(t,r);n++)a.mat[n][n]=1;return a},this.unit=function(t,r){for(var a=_(t,r),n=0;n<t;n++)for(var e=0;e<r;e++)a.mat[n][e]=1;return a},this.random=function(t,r){for(var n=_(t,r),e=0;e<t;e++)for(var i=0;i<r;i++)n.mat[e][i]=a(Math.random());return n},this.copy=function(t,r,a,n,e){i("copy",1,t);for(var o=_(n,e),m=0;m<n;m++)for(var u=0;u<e;u++)o.mat[m][u]=t.mat[m+r][u+a];return o},this.transpose=function(t){i("transpose",1,t);for(var r=_(t.n,t.m),a=0;a<r.m;a++)for(var n=0;n<r.n;n++)r.mat[a][n]=t.mat[n][a];return r},this.diagOf=function(t){i("diagOf",1,t);for(var r=_(Math.min(t.m,t.n),1),a=0;a<r.m;a++)r.mat[a][0]=t.mat[a][a];return r},this.diag=function(t){if(i("diag",1,t),1!=t.n)throw"***ERROR: in Matrix.diag: argument 1 is not a column vector.";for(var r=e.identity(t.m,t.m),a=0;a<r.m;a++)r.mat[a][a]=t.mat[a][0];return r},this.max=function(t){i("max",1,t);for(var r=t.mat[0][0],n=0;n<t.m;n++)for(var e=0;e<t.n;e++)t.mat[n][e]>r&&(r=t.mat[n][e]);return a(r)},this.min=function(t){i("min",1,t);for(var r=t.mat[0][0],n=0;n<t.m;n++)for(var e=0;e<t.n;e++)t.mat[n][e]<r&&(r=t.mat[n][e]);return a(r)},this.scale=function(t,r){i("scale",1,t);for(var n=o(t.mat),e=0;e<n.m;e++)for(var _=0;_<n.n;_++)n.mat[e][_]=a(r*n.mat[e][_]);return n},this.add=function(t,r){if(i("add",1,t),i("add",2,r),t.m!=r.m||t.n!=r.n)throw"***ERROR: in Matrix.add: matrix dimensions don't match.";for(var n=_(t.m,t.n),e=0;e<n.m;e++)for(var o=0;o<n.n;o++)n.mat[e][o]=a(t.mat[e][o]+r.mat[e][o]);return n},this.sub=function(t,r){if(i("sub",1,t),i("sub",2,r),t.m!=r.m||t.n!=r.n)throw"***ERROR: in Matrix.sub: matrix dimensions don't match.";for(var n=_(t.m,t.n),e=0;e<n.m;e++)for(var o=0;o<n.n;o++)n.mat[e][o]=a(t.mat[e][o]-r.mat[e][o]);return n},this.mult=function(t,r){if(i("mult",1,t),i("mult",2,r),t.n!=r.m)throw"***ERROR: in Matrix.mult: matrix dimensions don't match.";for(var n,e=_(t.m,r.n),o=0;o<e.m;o++)for(var m=0;m<e.n;m++){n=0;for(var u=0;u<t.n;u++)n+=t.mat[o][u]*r.mat[u][m];e.mat[o][m]=a(n)}return e},this.map=function(t,r){i("map",2,r);for(var n=_(r.m,r.n),e=0;e<n.m;e++)for(var o=0;o<n.n;o++)n.mat[e][o]=a(t(r.mat[e][o]));return n},this.combine=function(t,r,n){if(i("combine",1,r),i("combine",2,n),r.m!=n.m||r.n!=n.n)throw"***ERROR: in Matrix.combine: matrix dimensions don't match.";for(var e=_(r.m,r.n),o=0;o<e.m;o++)for(var m=0;m<e.n;m++)e.mat[o][m]=a(t(r.mat[o][m],n.mat[o][m]));return e},this.trace=function(t){i("trace",1,t);for(var r=0,n=0;n<Math.min(t.m,t.n);n++)r+=t.mat[n][n];return a(r)},this.det=function(t){if(i("det",1,t),t.m!=t.n)throw"***ERROR: in Matrix.det: argument is not square.";return a(LUDecomposition.det(create(t)))},this.inverse=function(t){return i("inverse",1,t),e.solve(t,e.identity(t.m,t.m))},this.solve=function(t,r){if(i("solve",1,t),i("solve",2,r),t.m==t.n)return LUDecomposition.solve(create(t),r);if(t.m>t.n){var a=create(t);return QRDecomposition.solve(a,r)}throw"***ERROR: in Matrix.solve: argument 1 has fewer rows than columns."},this.eigenstructure=function(t){if(i("eigenstructure",1,t),t.m!=t.n)throw"***ERROR: in Matrix.eigenstructure: argument is not a square matrix.";return EVDecomposition.create(t)},this.display=function(t,r){i("display",1,t),null==r&&(r=3),displayMat(t.mat,null,null,r)}};r.a=e},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _matrix__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0);const madd=t=>t/sum,mpwr=t=>t*t,div=(t,r)=>t/r,LogGamma=t=>{const r=1+76.18009173/t-86.50532033/(t+1)+24.01409822/(t+2)-1.231739516/(t+3)+.00120858003/(t+4)-536382e-11/(t+5);return(t-.5)*Math.log(t+4.5)-(t+4.5)+Math.log(2.50662827465*r)},Gcf=(t,r)=>{let a=0,n=1,e=1,i=t,o=0,_=0;for(;Math.abs((e-o)/e)>1e-5;)o=e,e=t*(a=e+((_+=1)-r)*a)+_*e,a/=i=t*(n=i+(_-r)*n)+_*i,n/=i,e/=i,i=1;return 1-Math.exp(r*Math.log(t)-t-LogGamma(r))*e},Gser=(t,r)=>{let a=1/r,n=a,e=1;for(;a>1e-5*n;)n+=a=a*t/(r+e),e+=1;return n*=Math.exp(r*Math.log(t)-t-LogGamma(r))},Gammacdf=(t,r)=>{let a;return a=t<=0?0:t<r+1?Gser(t,r):Gcf(t,r)},computeP=(chi,df)=>{const Z=eval(chi),DF=eval(df);let Chisqcdf;return DF<=0?console.error("Degrees of freedom must be positive"):Chisqcdf=Gammacdf(Z/2,DF/2),Chisqcdf=Math.round(1e5*Chisqcdf)/1e5,Chisqcdf<1?(1-Chisqcdf).toFixed(5):0},analyse=t=>{const r=_matrix__WEBPACK_IMPORTED_MODULE_0__.a.create(t),a=_matrix__WEBPACK_IMPORTED_MODULE_0__.a.map(function(){return 1},r),n=_matrix__WEBPACK_IMPORTED_MODULE_0__.a.create(a.mat.slice(0,1)),e=_matrix__WEBPACK_IMPORTED_MODULE_0__.a.transpose(_matrix__WEBPACK_IMPORTED_MODULE_0__.a.create(_matrix__WEBPACK_IMPORTED_MODULE_0__.a.transpose(a).mat.slice(0,1)));sum=_matrix__WEBPACK_IMPORTED_MODULE_0__.a.mult(_matrix__WEBPACK_IMPORTED_MODULE_0__.a.mult(_matrix__WEBPACK_IMPORTED_MODULE_0__.a.transpose(a),r),_matrix__WEBPACK_IMPORTED_MODULE_0__.a.transpose(n)).mat[1];const i=_matrix__WEBPACK_IMPORTED_MODULE_0__.a.mult(n,_matrix__WEBPACK_IMPORTED_MODULE_0__.a.transpose(r)),o=_matrix__WEBPACK_IMPORTED_MODULE_0__.a.mult(_matrix__WEBPACK_IMPORTED_MODULE_0__.a.transpose(r),e);let _=_matrix__WEBPACK_IMPORTED_MODULE_0__.a.transpose(_matrix__WEBPACK_IMPORTED_MODULE_0__.a.mult(o,i));_=_matrix__WEBPACK_IMPORTED_MODULE_0__.a.map(madd,_);var m=_matrix__WEBPACK_IMPORTED_MODULE_0__.a.sub(r,_);m=_matrix__WEBPACK_IMPORTED_MODULE_0__.a.map(mpwr,m),m=_matrix__WEBPACK_IMPORTED_MODULE_0__.a.combine(div,m,_);const u=(m=_matrix__WEBPACK_IMPORTED_MODULE_0__.a.mult(_matrix__WEBPACK_IMPORTED_MODULE_0__.a.mult(a,_matrix__WEBPACK_IMPORTED_MODULE_0__.a.transpose(m)),e)).mat[1],s=(r.m-1)*(r.n-1);return{chi:u,df:s,pValue:computeP(u,s)}};__webpack_exports__.default=analyse}])});